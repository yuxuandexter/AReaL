experiment_name: tests-grpo
trial_name: trial
cluster:
  n_nodes: 1
  n_gpus_per_node: 2
  fileroot: /tmp/areal/experiments
allocation_mode: sglang:d1p1t1+d1p1t1
seed: 1
total_train_epochs: 1
total_train_steps: 16
tokenizer_path: ${actor.path}
train_dataset:
  path: openai/gsm8k
  batch_size: 64
  max_length: 512
  type: rl
saver:
  experiment_name: ${experiment_name}
  trial_name: ${trial_name}
  fileroot: ${cluster.fileroot}
evaluator:
  experiment_name: ${experiment_name}
  trial_name: ${trial_name}
  fileroot: ${cluster.fileroot}
stats_logger:
  experiment_name: ${experiment_name}
  trial_name: ${trial_name}
  fileroot: ${cluster.fileroot}
recover:
  experiment_name: ${experiment_name}
  trial_name: ${trial_name}
  fileroot: ${cluster.fileroot}
sglang:
  model_path: ${actor.path}
  random_seed: ${seed}
launcher: {}
gconfig:
  n_samples: 4
  max_new_tokens: 1024

rollout:
  experiment_name: ${experiment_name}
  trial_name: ${trial_name}
  consumer_batch_size: ${train_dataset.batch_size}

actor:
  experiment_name: ${experiment_name}
  trial_name: ${trial_name}
  path: Qwen/Qwen3-0.6B
  mb_spec:
    max_tokens_per_mb: 4096
  optimizer:
    type: adam
    lr: 1.70e-5
    weight_decay: 0.017
    beta1: 0.9
    beta2: 0.999
    eps: 1e-8
    lr_scheduler_type: constant
    gradient_clipping: 1.0
    warmup_steps_proportion: 0.001
  group_size: ${gconfig.n_samples}
  adv_norm:
    mean_level: batch
    std_level: batch

ref:
  experiment_name: ${experiment_name}
  trial_name: ${trial_name}
  path: ${actor.path}
  mb_spec:
    max_tokens_per_mb: 4096
